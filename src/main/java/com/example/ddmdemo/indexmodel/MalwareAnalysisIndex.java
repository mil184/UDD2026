package com.example.ddmdemo.indexmodel;

import lombok.*;
import org.springframework.data.annotation.Id;
import org.springframework.data.annotation.Transient;
import org.springframework.data.elasticsearch.annotations.*;

import java.util.List;
import java.util.Map;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Document(indexName = "malware_analysis")
@Setting(settingPath = "/configuration/serbian-analyzer-config.json")
public class MalwareAnalysisIndex {

    @Id
    private String id;

    @MultiField(
            mainField = @Field(type = FieldType.Text),
            otherFields = { @InnerField(suffix = "keyword", type = FieldType.Keyword) }
    )
    private String fileName;

    @MultiField(
            mainField = @Field(type = FieldType.Text),
            otherFields = { @InnerField(suffix = "keyword", type = FieldType.Keyword) }
    )
    private String analystFullName;

    @MultiField(
            mainField = @Field(type = FieldType.Text),
            otherFields = { @InnerField(suffix = "keyword", type = FieldType.Keyword) }
    )
    private String securityOrganization;

    @MultiField(
            mainField = @Field(type = FieldType.Text),
            otherFields = { @InnerField(suffix = "keyword", type = FieldType.Keyword) }
    )
    private String malwareName;

    @Field(type = FieldType.Text, name = "behaviorDescriptionSr", analyzer = "serbian_custom", searchAnalyzer = "serbian_custom")
    private String behaviorDescriptionSr;

    @Field(type = FieldType.Text, name = "behaviorDescriptionEn", analyzer = "english", searchAnalyzer = "english")
    private String behaviorDescriptionEn;

    @Field(type = FieldType.Keyword)
    private String threatClassification;

    @Field(type = FieldType.Keyword)
    private String sampleHash;

    @Transient
    private Map<String, List<String>> highlights;
}